<!doctype html>
<html lang="en-US">
    <head>
        <!-- <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js?ver=3.3.1"></script> -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-cookie/1.4.1/jquery.cookie.min.js" integrity="sha256-1A78rJEdiWTzco6qdn3igTBv9VupN3Q1ozZNTR4WE/Y=" crossorigin="anonymous"></script>
    </head>
    <body>
        <script>

            function getCookie(name){
                var re = new RegExp(name + "=([^;]+)");
                var value = re.exec(document.cookie);
                return (value != null) ? unescape(value[1]) : null;
            }

            if(document.cookie.indexOf('lnc_session_id') > -1){
                console.log('Session ID is: ' + getCookie('lnc_session_id'));
            }else{
                var xhr = new XMLHttpRequest();
                xhr.open('GET', 'https://lnc-analytics.herokuapp.com/session/open');
                xhr.onload = function() {
                    if (xhr.status === 200) {
                        document.cookie = 'lnc_session_id=' + xhr.responseText + '; path=/; expires=3011';
                        console.log('Session ID is set to: ' + xhr.responseText);
                    }
                    else {
                        alert('Request failed.  Returned status of ' + xhr.status);
                    }
                }
                xhr.send();
            }
        </script>
    </body>
</html>